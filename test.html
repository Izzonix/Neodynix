<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pesapal Payment</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <h1>Pay KES 1000</h1>
  <button id="pay">Pay Now</button>

  <script>
    const supabase = Supabase.createClient('YOUR_SUPABASE_URL', 'YOUR_ANON_KEY')

    document.getElementById('pay').addEventListener('click', async () => {
      const { data: { user } } = await supabase.auth.getUser()
      if (!user) return alert('Login required')

      const { data, error } = await supabase.functions.invoke('submit-order', {
        body: { amount: 1000, description: 'Test Payment', user_id: user.id }
      })
      if (error) return alert(error.message)

      window.location.href = data.redirect_url
    })
  </script>
</body>
</html>
